<!DOCTYPE html>
<html lang="pt-br">
<head>
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Visualizar Código - Adega</title>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: Consolas, monospace;
            padding: 20px;
            font-size: 10px; /* Fonte pequena pra caber mais */
        }
        h1 {
            color: violet;
            font-size: 16px;
        }
        pre {
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 15px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-word;
        }
        a {
            color: violet;
            text-decoration: none;
        }
    </style>
</head>
<body style="background-color:#111; color:#fff; font-family: monospace; white-space: pre-wrap;">
    <h1>import customtkinter as ctk
        import pyodbc
        
        dados_conexao = (
            "Driver ={SQL Server};"
            "Server = desk...;"
            "Database = adega;"
            "UID= id...;"
            "PWD=senha..."
        )
        
        conexao = pyodbc.connect(dados_conexao)
        print("Conexão realizada com sucesso!")
        cursor = conexao.cursor()
        
        def janela_login():
            ctk.set_appearance_mode('dark')
            tela_login = ctk.CTk()
            tela_login.geometry('400x400')
            tela_login.title('Login')
            frame1 = ctk.CTkFrame(tela_login, width=300, height=350)
            frame1.pack(pady=10, padx=10, anchor='center')
            frame1.pack_propagate(False)
            frame2 = ctk.CTkFrame(frame1, width=200, height=50)
            frame2.pack(pady=10, padx=10)
            frame2.pack_propagate(False)
            label1 = ctk.CTkLabel(frame2, text='Faça o login', font=('arial', 20, 'bold'))
            label1.pack(pady=10)
            label_usuario = ctk.CTkLabel(frame1, text='Usuário', font=('arial', 15, 'bold'))
            label_usuario.pack(pady=2)
            campo_usuario = ctk.CTkEntry(frame1, placeholder_text='Digite o usuário')
            campo_usuario.pack(pady=8)
            label_senha = ctk.CTkLabel(frame1, text='Senha', font=('arial', 15, 'bold'))
            label_senha.pack(pady=8)
            campo_senha = ctk.CTkEntry(frame1, placeholder_text='Digite a senha', show='*')
            campo_senha.pack(pady=2)
            btn_login = ctk.CTkButton(frame1, text='Login', width=200, height=30, corner_radius=10,
                                  fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                                  command=lambda: validar_login(campo_usuario, campo_senha, resultado_login, tela_login))
            btn_login.pack(pady=43)
            resultado_login = ctk.CTkLabel(frame1, text='', font=('arial', 15, 'bold'))
            resultado_login.pack(pady=10)
            tela_login.mainloop()
        
        def validar_login(campo_usuario, campo_senha, resultado_login, tela_login):
            usuario_login = campo_usuario.get()
            senha_login = campo_senha.get()
            if usuario_login == 'adega' and senha_login == '12345':
                resultado_login.configure(text='Login realizado com sucesso!', text_color='green')
                tela_login.destroy()
                janela_adega()
            else:
                resultado_login.configure(text='Usuário ou senha incorretos', text_color='red')
            
        def janela_adega():
            tela_adega = ctk.CTk()
            ctk.set_appearance_mode('dark')
            tela_adega.geometry('800x600')
            tela_adega.title('Adega *******')
            tela_adega.iconbitmap("uvas2.ico") 
            frame_adega = ctk.CTkFrame(tela_adega, width=700, height=500, corner_radius=15)
            frame_adega.place(relx=0.5, rely=0.5, anchor='center')
            frame_adega.pack_propagate(False)
            titulo_bemvindo = ctk.CTkLabel(frame_adega, text='Bem vindo ao gerenciamento da Adega *****!', font=('Arial', 24, 'bold'))
            titulo_bemvindo.pack(pady=50, padx = 20)
            titulo2 = ctk.CTkLabel(frame_adega, text='O que deseja fazer?', font=('Arial', 20, 'bold'))
            titulo2.pack(pady=20, padx = 20)
            btn_cadastrar = ctk.CTkButton(frame_adega, text='Cadastrar novo vinho', corner_radius=10,
                                  fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                                  width=250, height=40, command=lambda: inserir)
            btn_cadastrar.pack(pady=10, padx=10)
            btn_cadastrar.pack_propagate(False)
            btn_atualizar = ctk.CTkButton(frame_adega, text='Atualizar vinho', corner_radius=10,
                                  fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                                  width=250, height=40, command=lambda: atualizar)
            btn_atualizar.pack(pady=10, padx=10)
            btn_atualizar.pack_propagate(False)
            btn_deletar = ctk.CTkButton(frame_adega, text='Deletar vinho',corner_radius=10,
                                  fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                                  width=250, height=40, command=lambda: deletar)
            btn_deletar.pack(pady=10, padx=10)
            btn_deletar.pack_propagate(False)
            btn_listar = ctk.CTkButton(frame_adega, text='Listar vinhos', corner_radius=10,
                                  fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                                  width=250, height=40, command=lambda: listar)
            btn_listar.pack(pady=10, padx=10)
            btn_listar.pack_propagate(False)
            tela_adega.mainloop()
        
        def inserir():
          nome = input("Nome do vinho: ")
          tipo = input("Tipo de vinho: ")
          try:
            (input("Ano de fabricação: "))
            safra = datetime.strptime(ano, "%Y").date()
            quantidade = int(input("Quantidade (ml): "))
            preço = float(input("Preço (R$): "))
            criar_vinho(conexao,nome,tipo,safra,quantidade,preço)
            print("Vinho inserido com sucesso!")
          except ValueError:
            print("Erro nos valores.")
        
        def deletar():
            nome_vinho = input("Digite o nome do vinho que deseja excluir: ")
            tipo_vinho = input("Digite o tipo de vinho que deseja excluir (deixe em branco se não souber): ")
            ano_vinho = input("Digite o ano de fabricação do vinho que deseja excluir (deixe em branco se não souber): ")
        
            try:
                if nome_vinho and not tipo_vinho and not ano_vinho:
                    cursor.execute("DELETE FROM tbl_vinhos WHERE nome = ?", (nome_vinho,))
                elif nome_vinho and tipo_vinho and not ano_vinho:
                    cursor.execute("DELETE FROM tbl_vinhos WHERE nome = ? AND tipo = ?", (nome_vinho, tipo_vinho))
                elif nome_vinho and tipo_vinho and ano_vinho:
                    cursor.execute("DELETE FROM tbl_vinhos WHERE nome = ? AND tipo = ? AND ano = ?", (nome_vinho, tipo_vinho, ano_vinho))
                elif nome_vinho and not tipo_vinho and ano_vinho:
                    cursor.execute("DELETE FROM tbl_vinhos WHERE nome = ? AND ano = ?", (nome_vinho, ano_vinho))
        
                conexao.commit()
        
                if cursor.rowcount > 0:
                    tipo_vinho = tipo_vinho if tipo_vinho else "desconhecido"
                    ano_vinho = ano_vinho if ano_vinho else "desconhecido"
                    print(f"O vinho {nome_vinho} ({tipo_vinho}, {ano_vinho}) foi deletado com sucesso!")
                else:
                    print("Não foi encontrado nenhum vinho com essas informações.")
            except Exception as e:
                print(f"Ocorreu um erro ao tentar deletar o vinho: {e}")
        
        def atualizar():
            tela_atualizar = ctk.CTkToplevel()
            tela_atualizar.title("Atualizar Vinho")
            tela_atualizar.geometry("400x300")
        
            ctk.CTkLabel(tela_atualizar, text="Nome atual do vinho:").pack(pady=10)
            entry_nome_atual = ctk.CTkEntry(tela_atualizar, placeholder_text="Digite o nome atual do vinho:")
            entry_nome_atual.pack()
        
            ctk.CTkLabel(tela_atualizar, text="Novo nome do vinho:").pack(pady=10)
            entry_nome_novo = ctk.CTkEntry(tela_atualizar, placeholder_text="Digite o novo nome do vinho:")
            entry_nome_novo.pack()
        
            def executar_atualizacao_local():
                nome_atual = entry_nome_atual.get()
                nome_novo = entry_nome_novo.get()
                cursor = conexao.cursor()
                try:
                    cursor.execute("UPDATE tbl_vinhos SET nome_vinho = %s WHERE nome_vinho = %s", (nome_novo, nome_atual))
                    conexao.commit()
                    ctk.CTkLabel(tela_atualizar, text="Atualizado com sucesso!", text_color="green").pack(pady=10)
                except Exception as e:
                    ctk.CTkLabel(tela_atualizar, text=f"Erro: {e}", text_color="red").pack(pady=10)
        
            ctk.CTkButton(tela_atualizar, text="Atualizar", command=executar_atualizacao_local).pack(pady=20)
        
                    
                    
        
        
        def listar(conexao):
          cursor = conexao.cursor()
          cursor.execute("SELECT * FROM tbl_vinhos")
          tbl_vinhos = cursor.fetchall()
          for vinho in tbl_vinhos:
                print(vinho)
        
        janela_adega()
        
        </h1>
</body>
</html>
