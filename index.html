<!DOCTYPE html>
<html lang="pt-br">
<head>
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Código Projeto Adega</title>
    <link rel="icon" type="image/x-icon" href="uvas.ico">
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: Consolas, monospace;
            padding: 20px;
            font-size: 8px; 
        }
        h1 {
            color: violet;
            font-size: 14px;
        }
        pre {
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 15px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-word;
        }
        a {
            color: violet;
            text-decoration: none;
        }
    </style>
</head>
<body style="background-color:#111; color:#fff; font-family: monospace; white-space: pre-wrap;">
    <h1>
        
<img src="uvas.ico" alt="Ícone de uvas" width="64" height="64">
        
---PYTHON---

import customtkinter as ctk
import mysql.connector
from datetime import datetime

conexao = mysql.connector.connect(
    host="127.0.0.1",
    port=3306,
    user="root",
    password="root",
    database="adega"
)

cursor = conexao.cursor()
print("Conectado ao MySQL com sucesso!")

def janela_login():
    ctk.set_appearance_mode('dark')
    tela_login = ctk.CTk()
    tela_login.geometry('400x400')
    tela_login.title('Login Adega 4 amigos')
    tela_login.iconbitmap("uvas.ico") 
    frame1 = ctk.CTkFrame(tela_login, width=300, height=350)
    frame1.pack(pady=10, padx=10, anchor='center')
    frame1.pack_propagate(False)
    frame2 = ctk.CTkFrame(frame1, width=200, height=50)
    frame2.pack(pady=10, padx=10)
    frame2.pack_propagate(False)
    label1 = ctk.CTkLabel(frame2, text='Faça o login', font=('arial', 20, 'bold'))
    label1.pack(pady=10)
    label_usuario = ctk.CTkLabel(frame1, text='Usuário', font=('arial', 15, 'bold'))
    label_usuario.pack(pady=2)
    campo_usuario = ctk.CTkEntry(frame1, placeholder_text='Digite o usuário')
    campo_usuario.pack(pady=8)
    label_senha = ctk.CTkLabel(frame1, text='Senha', font=('arial', 15, 'bold'))
    label_senha.pack(pady=8)
    campo_senha = ctk.CTkEntry(frame1, placeholder_text='Digite a senha', show='*')
    campo_senha.pack(pady=2)
    btn_login = ctk.CTkButton(frame1, text='Login', width=200, height=30, corner_radius=10,
                          fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                          command=lambda: validar_login(campo_usuario, campo_senha, resultado_login, tela_login))
    btn_login.pack(pady=35)
    resultado_login = ctk.CTkLabel(frame1, text='', font=('arial', 15, 'bold'))
    resultado_login.pack(pady=5)
    tela_login.mainloop()

def validar_login(campo_usuario, campo_senha, resultado_login, tela_login):
    usuario_login = campo_usuario.get()
    senha_login = campo_senha.get()
    if usuario_login == 'adega' and senha_login == '12345':
        tela_login.withdraw()
        janela_adega()
    else:
        resultado_login.configure(text='Usuário ou senha incorretos', text_color='red')
    
def janela_adega():
    tela_adega = ctk.CTk()
    ctk.set_appearance_mode('dark')
    tela_adega.geometry('800x600')
    tela_adega.title('Adega 4 amigos')
    tela_adega.iconbitmap("uvas.ico") 
    frame_adega = ctk.CTkFrame(tela_adega, width=700, height=500, corner_radius=15)
    frame_adega.place(relx=0.5, rely=0.5, anchor='center')
    frame_adega.pack_propagate(False)
    titulo_bemvindo = ctk.CTkLabel(frame_adega, text='Bem vindo ao gerenciamento da Adega 4 amigos!', font=('Arial', 24, 'bold'))
    titulo_bemvindo.pack(pady=50, padx = 20)
    titulo2 = ctk.CTkLabel(frame_adega, text='O que deseja fazer?', font=('Arial', 20, 'bold'))
    titulo2.pack(pady=20, padx = 20)
    btn_inserir = ctk.CTkButton(frame_adega, text='Cadastrar vinho', corner_radius=10,
                          fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                          width=250, height=40, command=lambda: inserir(conexao))
    btn_inserir.pack(pady=10, padx=10)
    btn_inserir.pack_propagate(False)
    btn_atualizar = ctk.CTkButton(frame_adega, text='Atualizar vinho', corner_radius=10,
                          fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                          width=250, height=40, command=lambda: atualizar(conexao))
    btn_atualizar.pack(pady=10, padx=10)
    btn_atualizar.pack_propagate(False)
    btn_deletar = ctk.CTkButton(frame_adega, text='Deletar vinho',corner_radius=10,
                          fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                          width=250, height=40, command=lambda: deletar(conexao))
    btn_deletar.pack(pady=10, padx=10)
    btn_deletar.pack_propagate(False)
    btn_listar = ctk.CTkButton(frame_adega, text='Listar vinhos', corner_radius=10,
                          fg_color='purple', hover_color='violet', font=('roboto', 12, 'bold'),
                          width=250, height=40, command=lambda: listar(conexao))
    btn_listar.pack(pady=10, padx=10)
    btn_listar.pack_propagate(False)
    tela_adega.mainloop()

def inserir(conexao):
    janela = ctk.CTkToplevel()
    janela.title("Inserir Vinho")
    janela.geometry("300x400")
    entry_nome = ctk.CTkEntry(janela, placeholder_text="Nome")
    entry_nome.pack(pady=10)
    entry_tipo = ctk.CTkEntry(janela, placeholder_text="Tipo")
    entry_tipo.pack(pady=10)
    entry_safra = ctk.CTkEntry(janela, placeholder_text="Safra (AAAA-MM-DD)")
    entry_safra.pack(pady=10)
    entry_quantidade = ctk.CTkEntry(janela, placeholder_text="Quantidade (ml)")
    entry_quantidade.pack(pady=10)
    entry_valor = ctk.CTkEntry(janela, placeholder_text="Valor (R$)")
    entry_valor.pack(pady=10)
    resultado = ctk.CTkLabel(janela, text="")
    resultado.pack(pady=10)
    
    def criar_vinho(conexao, nome, tipo, safra, quantidade, valor):
        cursor = conexao.cursor()
        cursor.execute(
            "INSERT INTO tbl_vinhos (nome_vinho, tipo_vinho, safra, quantidade, valor_vinho) VALUES (%s, %s, %s, %s, %s)",
            (nome, tipo, safra, quantidade, valor)
        )
        conexao.commit()

    def salvar():
        try:
            nome = entry_nome.get()
            tipo = entry_tipo.get()
            safra = entry_safra.get()
            safra = datetime.strptime(str(safra), "%Y-%m-%d").date() 
            quantidade = int(entry_quantidade.get())
            preco = float(entry_valor.get())
            criar_vinho(conexao, nome, tipo, safra, quantidade, preco)
            resultado.configure(text="Vinho cadastrado com sucesso!", text_color="green")
        except ValueError:
            resultado.configure(text="Erro: data ou valores inválidos (use AAAA-MM-DD).", text_color="red")
        except Exception as e:
            resultado.configure(text=f"Erro: {e}", text_color="red")
    ctk.CTkButton(janela, text="Salvar", command=salvar).pack(pady=20)
    entry_nome.delete(0, 'end')
    entry_tipo.delete(0, 'end')
    entry_safra.delete(0, 'end')
    entry_quantidade.delete(0, 'end')
    entry_valor.delete(0, 'end')


def deletar(conexao):
    janela = ctk.CTkToplevel()
    janela.title("Deletar Vinho")
    janela.geometry("400x500")

    ctk.CTkLabel(janela, text="Digite o nome do vinho para buscar:").pack(pady=10)
    entry_nome = ctk.CTkEntry(janela, placeholder_text="Nome do vinho")
    entry_nome.pack(pady=10)
    ctk.CTkButton(janela, text="Buscar", command=buscar_vinhos).pack(pady=5)

    frame_resultados = ctk.CTkFrame(janela)
    frame_resultados.pack(pady=10, fill="both", expand=True)

    def buscar_vinhos():
        for widget in frame_resultados.winfo_children():
            widget.destroy()

        nome = entry_nome.get()
        cursor = conexao.cursor()
        cursor.execute("SELECT id, nome_vinho, tipo, safra FROM tbl_vinhos WHERE nome_vinho = %s", (nome,))
        resultados = cursor.fetchall()

        if not resultados:
            ctk.CTkLabel(frame_resultados, text="Nenhum vinho encontrado.").pack()
        else:
            ctk.CTkLabel(frame_resultados, text="Vinhos encontrados:").pack(pady=5)
            for vinho in resultados:
                texto = f"ID: {vinho[0]} | Nome: {vinho[1]} | Tipo: {vinho[2]} | Safra: {vinho[3]}"
                btn = ctk.CTkButton(frame_resultados, text=texto, command=lambda id=vinho[0], desc=texto: confirmar_exclusao(id, desc))
                btn.pack(pady=2)

    def confirmar_exclusao(id_vinho, descricao):
        for widget in frame_resultados.winfo_children():
            widget.destroy()

        ctk.CTkLabel(frame_resultados, text=f"Tem certeza que deseja excluir:\n{descricao}").pack(pady=10)

        def excluir():
            try:
                cursor = conexao.cursor()
                cursor.execute("DELETE FROM tbl_vinhos WHERE id = %s", (id_vinho,))
                conexao.commit()
                ctk.CTkLabel(frame_resultados, text="Vinho deletado com sucesso!", text_color="green").pack()
            except Exception as e:
                ctk.CTkLabel(frame_resultados, text=f"Erro ao deletar: {e}", text_color="red").pack()

        ctk.CTkButton(frame_resultados, text="Confirmar exclusão", fg_color="red", command=excluir).pack(pady=5)
        ctk.CTkButton(frame_resultados, text="Cancelar", command=buscar_vinhos).pack(pady=2)



def atualizar(conexao):
    tela_atualizar = ctk.CTkToplevel()
    tela_atualizar.title("Atualizar Vinho")
    tela_atualizar.geometry("800x600")
    ctk.CTkLabel(tela_atualizar, text="Nome atual do vinho:").pack(pady=10)
    entry_nome_atual = ctk.CTkEntry(tela_atualizar, placeholder_text="Digite o nome atual do vinho:")
    entry_nome_atual.pack()
    ctk.CTkLabel(tela_atualizar, text="Novo nome do vinho:").pack(pady=10)
    entry_nome_novo = ctk.CTkEntry(tela_atualizar, placeholder_text="Digite o novo nome do vinho:")
    entry_nome_novo.pack()

    def executar_atualizacao_local():
        nome_atual = entry_nome_atual.get()
        nome_novo = entry_nome_novo.get()
        cursor = conexao.cursor()
        try:
            cursor.execute("UPDATE tbl_vinhos SET nome_vinho = %s WHERE nome_vinho = %s", (nome_novo, nome_atual))
            conexao.commit()
            ctk.CTkLabel(tela_atualizar, text="Atualizado com sucesso!", text_color="green").pack(pady=10)
        except Exception as e:
            ctk.CTkLabel(tela_atualizar, text=f"Erro: {e}", text_color="red").pack(pady=10)

    ctk.CTkButton(tela_atualizar, text="Atualizar", command=executar_atualizacao_local).pack(pady=20)

def listar(conexao):
    tela_listar = ctk.CTkToplevel()
    tela_listar.title("Lista de Vinhos")
    tela_listar.geometry("700x500")
    frame = ctk.CTkFrame(tela_listar)
    frame.pack(pady=20, padx=20, fill="both", expand=True)
    scrollable = ctk.CTkScrollableFrame(frame, label_text="Vinhos cadastrados")
    scrollable.pack(padx=10, pady=10, fill="both", expand=True)
    cursor = conexao.cursor()
    cursor.execute("SELECT id, nome_vinho, tipo_vinho, safra, quantidade, valor_vinho FROM tbl_vinhos")
    vinhos = cursor.fetchall()
    if not vinhos:
        ctk.CTkLabel(scrollable, text="Nenhum vinho cadastrado.", text_color="red").pack(pady=10)
    else:
        for vinho in vinhos:
            texto = (
                f"ID: {vinho[0]} | Nome: {vinho[1]} | Tipo: {vinho[2]} | "
                f"Safra: {vinho[3]} | Quantidade: {vinho[4]}ml | Valor: R${vinho[5]:.2f}"
            )
            ctk.CTkLabel(scrollable, text=texto, anchor="w", justify="left").pack(pady=5, padx=10, anchor='w')
    
janela_login()     
        
-------------------------------------------------------------------------------------------------------------------------

---MYSQL---
        
CREATE DATABASE adega;
USE adega;

CREATE TABLE tbl_fabricantes (
    id_fabricante INT AUTO_INCREMENT PRIMARY KEY,
    data_entregue DATE,
    nome_fabricante VARCHAR(100)
);

CREATE TABLE tbl_vinhos (
    id_vinho INT AUTO_INCREMENT PRIMARY KEY,
    nome_vinho VARCHAR(100) NOT NULL,
    tipo_vinho VARCHAR(100) NOT NULL,
    safra DATE NOT NULL,
    quantidade FLOAT,
    valor_vinho DECIMAL(10, 2),
    id_fabricante INT,
    FOREIGN KEY (id_fabricante) REFERENCES fabricante(id_fabricante)
);

INSERT INTO tbl_fabricantes (data_entregue, nome_fabricante) VALUES 
('2024-05-01', 'Vinícola Aurora'),
('2024-05-02', 'Casa Valduga'),
('2024-05-03', 'Miolo Wine Group'),
('2024-05-04', 'Salton'),
('2024-05-05', 'Dom Bosco');

INSERT INTO tbl_vinhos (nome_vinho, tipo_vinho, safra, quantidade, valor_vinho, id_fabricante) VALUES
('Aurora Reserva', 'Tinto Seco', '2020-01-01', 120.5, 45.90, 1),
('Valduga Chardonnay', 'Branco Seco', '2021-01-01', 85.0, 59.90, 2),
('Miolo Merlot', 'Tinto Seco', '2019-01-01', 200.0, 62.50, 3),
('Valduga Espumante', 'Espumante Brut', '2022-01-01', 150.0, 75.00, 2),
('Salton', 'Tinto Seco', '2018-01-01', 110.0, 38.90, 4),
('Dom Bosco', 'Tinto Suave', '2021-01-01', 300.0, 25.50, 5),
('Aurora Moscato', 'Branco Suave', '2022-01-01', 90.0, 34.90, 1),
('Miolo Seleção', 'Rosé Seco', '2023-01-01', 75.0, 48.00, 3),
('Casa Valduga Terroir', 'Tinto Seco', '2020-01-01', 130.0, 82.00, 2);

        
        
        </h1>
</body>
</html>
